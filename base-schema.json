{
   "type":"object",
   "properties":{
      "name":{
         "type":"string",
         "title":"Name",
         "minLength":1,
         "maxLength":128
      },
      "description":{
         "type":"string",
         "title":"Description",
         "minLength":1,
         "maxLength":1024
      },
      "category":{
         "type":"string",
         "title":"Source Category",
         "minLength":1,
         "maxLength":1024
      },
      "fields":{
         "type":"object",
         "properties":{
            "_siemForward":{
               "type":"boolean",
               "title":"Forward to SIEM",
               "default":false,
               "flag":{
                  "type":"featureFlag",
                  "name":"UIHTTPSiemForward"
               }
            }
         },
         "additionalProperties":{
            "title":"Fields",
            "type":"string",
            "minLength":1,
            "maxLength":200
         }
      },
      "multilineEnabled":{
         "title":"Detect messages spanning multiple lines",
         "type":"boolean",
         "default":false
      },
      "automaticDateParsing":{
         "type":"boolean",
         "default":true,
         "title":"Extract timestamp information from log file entries"
      },
      "filters":{
         "type":"array",
         "items":{
            "type":"object",
            "properties":{
               "name":{
                  "type":"string",
                  "title":"Name",
                  "minLength":1,
                  "maxLength":32
               },
               "regexp":{
                  "type":"string",
                  "title":"Filter",
                  "minLength":1
               },
               "filterType":{
                  "title":"Type",
                  "type":"string",
                  "default":"Exclude",
                  "enum":[
                     "Exclude",
                     "Include",
                     "Hash",
                     "Mask"
                  ],
                  "enumNames":[
                     "Exclude messages that match",
                     "Include messages that match",
                     "Hash messages that match",
                     "Mask messages that match"
                  ]
               }
            },
            "required":[
               "name",
               "regexp",
               "filterType"
            ],
            "dependencies":{
               "filterType":{
                  "oneOf":[
                     {
                        "properties":{
                           "filterType":{
                              "enum":[
                                 "Mask"
                              ]
                           }
                        }
                     },
                     {
                        "properties":{
                           "filterType":{
                              "enum":[
                                 "Include"
                              ]
                           }
                        }
                     },
                     {
                        "properties":{
                           "filterType":{
                              "enum":[
                                 "Exclude"
                              ]
                           }
                        }
                     },
                     {
                        "properties":{
                           "filterType":{
                              "enum":[
                                 "Hash"
                              ]
                           }
                        }
                     }
                  ]
               }
            },
            "if":{
               "properties":{
                  "filterType":{
                     "const":"Mask"
                  }
               }
            },
            "then":{
               "properties":{
                  "mask":{
                     "title":"Type in a mask string.",
                     "type":"string",
                     "maxLength":64,
                     "default":"######"
                  }
               }
            }
         },
         "flag":{
            "type":"featureFlag",
            "name":"UINewProcessingRules"
         }
      }
   },
   "required":[
      "name"
   ]
}